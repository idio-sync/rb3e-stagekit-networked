<!-- manager.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Stage Kit Manager</title>
</head>
<body>
    <h1>Stage Kit Manager</h1>
    
    <input id="newIP" placeholder="192.168.1.150">
    <button onclick="addDevice()">Add Device</button>
    
    <div id="devices"></div>
    
    <script>
        let devices = JSON.parse(localStorage.getItem('devices') || '[]');
        
        function addDevice() {
            const ip = document.getElementById('newIP').value;
            if (!devices.includes(ip)) {
                devices.push(ip);
                localStorage.setItem('devices', JSON.stringify(devices));
                refreshDevices();
            }
        }
        
        async function refreshDevices() {
            const container = document.getElementById('devices');
            container.innerHTML = '';
            
            for (const ip of devices) {
                try {
                    const response = await fetch(`http://${ip}/status`);
                    const data = await response.json();
                    
                    container.innerHTML += `
                        <div class="device">
                            <strong>${ip}</strong>: ${data.status}
                            <button onclick="window.open('http://${ip}')">
                                Configure
                            </button>
                        </div>
                    `;
                } catch (e) {
                    container.innerHTML += `
                        <div class="device offline">
                            <strong>${ip}</strong>: Offline
                        </div>
                    `;
                }
            }
        }
        
        refreshDevices();
        setInterval(refreshDevices, 5000); // Update every 5 seconds
    </script>
</body>
</html>
